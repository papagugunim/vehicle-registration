<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì°¨ëŸ‰ ì…ì°¨ ë“±ë¡ ì‹œìŠ¤í…œ | Lotte KF</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #ED1C24 0%, #C8102E 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .lotte-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
            font-size: 1.3rem;
            font-weight: 700;
        }

        .lotte-logo img {
            height: 60px;
            width: auto;
        }

        .datetime-display {
            text-align: center;
            background: white;
            color: #333;
            font-size: 1rem;
            margin: 15px auto;
            padding: 12px 25px;
            border-radius: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            display: inline-block;
            font-weight: 500;
        }

        .datetime-display .date {
            font-size: 1.1rem;
            font-weight: 700;
            margin-right: 15px;
            color: #ED1C24;
        }

        .datetime-display .time {
            font-size: 1.1rem;
            font-weight: 700;
            color: #333;
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .subtitle {
            font-size: 1rem;
            opacity: 0.95;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tab-btn {
            flex: 1;
            padding: 12px;
            border: none;
            background: rgba(255,255,255,0.2);
            color: white;
            font-size: 0.95rem;
            font-weight: 700;
            cursor: pointer;
            border-radius: 12px;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }

        .tab-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .tab-btn.active {
            background: white;
            color: #ED1C24;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        label {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        input[type="text"],
        input[type="date"],
        input[type="time"],
        input[type="tel"],
        select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        input:focus,
        select:focus {
            outline: none;
            border-color: #ED1C24;
            box-shadow: 0 0 0 3px rgba(237, 28, 36, 0.1);
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .checkbox-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .checkbox-group label {
            margin: 0;
            cursor: pointer;
        }

        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .btn-primary {
            background: #ED1C24;
            color: white;
        }

        .btn-primary:hover {
            background: #C8102E;
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(237, 28, 36, 0.4);
        }

        .btn-primary:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .btn-success {
            background: #4caf50;
            color: white;
        }

        .btn-full {
            width: 100%;
        }

        .vehicle-list {
            margin-top: 20px;
        }

        .vehicle-item {
            padding: 15px;
            border: 2px solid #f0f0f0;
            border-radius: 12px;
            margin-bottom: 12px;
            transition: all 0.3s;
        }

        .vehicle-item:hover {
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-color: #ED1C24;
        }

        .vehicle-item.completed {
            background: #e8f5e9;
            border-color: #4caf50;
        }

        .vehicle-item.pending {
            background: #fff3e0;
            border-color: #ff9800;
        }

        .vehicle-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .vehicle-info {
            flex: 1;
        }

        .vehicle-number {
            font-weight: 700;
            font-size: 1.1rem;
            color: #333;
            margin-bottom: 5px;
        }

        .vehicle-details {
            color: #666;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .status-badge {
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 700;
        }

        .status-completed {
            background: #4caf50;
            color: white;
        }

        .status-pending {
            background: #ff9800;
            color: white;
        }

        .vehicle-actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 0.85rem;
        }

        .btn-secondary {
            background: #757575;
            color: white;
        }

        .btn-danger {
            background: #f44336;
            color: white;
        }

        .search-box {
            margin-bottom: 20px;
        }

        .search-box input {
            width: 100%;
        }

        .filter-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .filter-btn {
            padding: 8px 16px;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .filter-btn.active {
            background: #ED1C24;
            color: white;
            border-color: #ED1C24;
        }

        .export-section {
            display: flex;
            justify-content: flex-end;
            margin-bottom: 15px;
        }

        .export-btn {
            padding: 10px 20px;
            background: linear-gradient(135deg, #4caf50 0%, #45a049 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(76, 175, 80, 0.3);
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.4);
        }

        .export-btn:active {
            transform: translateY(0);
        }

        .success-message {
            background: #d4edda;
            border: 2px solid #4caf50;
            color: #155724;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            display: none;
        }

        .success-message.show {
            display: block;
            animation: fadeIn 0.4s;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.5rem;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .tabs {
                flex-direction: column;
            }

            .vehicle-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
        }

        .lang-selector {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 5px;
            background: rgba(255,255,255,0.2);
            padding: 5px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }

        .lang-btn {
            padding: 8px 16px;
            border: none;
            background: transparent;
            color: white;
            font-weight: 600;
            cursor: pointer;
            border-radius: 15px;
            transition: all 0.3s;
        }

        .lang-btn.active {
            background: white;
            color: #ED1C24;
        }

        .lang-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .lang-btn.active:hover {
            background: white;
        }

        /* AI ì´ë¯¸ì§€ ì—…ë¡œë“œ ì˜ì—­ */
        .ai-upload-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            margin-bottom: 25px;
            color: white;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .ai-section-header {
            padding: 15px 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            user-select: none;
            transition: background 0.3s;
        }

        .ai-section-header:hover {
            background: rgba(255,255,255,0.1);
        }

        .ai-section-header h3 {
            margin: 0;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .ai-toggle-icon {
            font-size: 1.2rem;
            transition: transform 0.3s;
        }

        .ai-toggle-icon.expanded {
            transform: rotate(180deg);
        }

        .ai-section-content {
            padding: 0 20px 20px 20px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease, padding 0.3s ease;
        }

        .ai-section-content.expanded {
            max-height: 800px;
            padding: 0 20px 20px 20px;
        }

        .upload-area {
            background: rgba(255,255,255,0.15);
            border: 2px dashed rgba(255,255,255,0.5);
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .upload-area:hover {
            background: rgba(255,255,255,0.25);
            border-color: rgba(255,255,255,0.8);
        }

        .upload-area.dragover {
            background: rgba(255,255,255,0.3);
            border-color: white;
            transform: scale(1.02);
        }

        .upload-icon {
            font-size: 3rem;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .upload-text {
            font-size: 1rem;
            margin-bottom: 5px;
        }

        .upload-hint {
            font-size: 0.85rem;
            opacity: 0.8;
        }

        #imagePreview {
            max-width: 100%;
            max-height: 300px;
            border-radius: 10px;
            margin-top: 15px;
            display: none;
        }

        .processing-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            flex-direction: column;
            gap: 20px;
        }

        .processing-overlay.show {
            display: flex;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .processing-text {
            color: white;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .btn-clear-image {
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 8px 16px;
            border: 1px solid rgba(255,255,255,0.5);
            border-radius: 8px;
            margin-top: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-clear-image:hover {
            background: rgba(255,255,255,0.3);
        }

        /* AI íƒ­ */
        .ai-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .ai-tab-btn {
            flex: 1;
            padding: 10px;
            border: 2px solid rgba(255,255,255,0.3);
            background: rgba(255,255,255,0.1);
            color: white;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .ai-tab-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        .ai-tab-btn.active {
            background: rgba(255,255,255,0.3);
            border-color: white;
        }

        .ai-tab-content {
            display: none;
        }

        .ai-tab-content.active {
            display: block;
        }

        #textInput {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 10px;
            background: rgba(255,255,255,0.15);
            color: white;
            font-size: 0.95rem;
            font-family: monospace;
            resize: vertical;
        }

        #textInput::placeholder {
            color: rgba(255,255,255,0.6);
        }

        .btn-extract {
            background: white;
            color: #667eea;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 10px;
            transition: all 0.3s;
        }

        .btn-extract:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        /* ë¡œê·¸ì¸ í˜ì´ì§€ */
        #loginPage {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .login-card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            max-width: 400px;
            width: 100%;
        }

        .login-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .login-header h1 {
            color: #ED1C24;
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        .login-header p {
            color: #666;
            font-size: 0.9rem;
        }

        .login-form .form-group {
            margin-bottom: 20px;
        }

        .login-form label {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .login-form input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .login-form input:focus {
            outline: none;
            border-color: #ED1C24;
            box-shadow: 0 0 0 3px rgba(237, 28, 36, 0.1);
        }

        .remember-me {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 20px;
        }

        .remember-me input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .remember-me label {
            margin: 0;
            cursor: pointer;
            font-weight: normal;
        }

        .login-error {
            background: #ffebee;
            color: #c62828;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
            text-align: center;
            font-size: 0.9rem;
        }

        .login-error.show {
            display: block;
        }

        .logout-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }

        .logout-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .user-info {
            position: absolute;
            top: 70px;
            left: 20px;
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 8px 16px;
            border-radius: 15px;
            font-size: 0.9rem;
            backdrop-filter: blur(10px);
        }

        #mainApp {
            display: none;
        }

        #mainApp.show {
            display: block;
        }
    </style>
</head>
<body>
    <!-- ë¡œê·¸ì¸ í˜ì´ì§€ -->
    <div id="loginPage">
        <!-- ë¡œê·¸ì¸ í˜ì´ì§€ ì–¸ì–´ ì„ íƒ -->
        <div class="lang-selector">
            <button class="lang-btn active" onclick="switchLanguage('ru')">RUS</button>
            <button class="lang-btn" onclick="switchLanguage('ko')">KOR</button>
        </div>

        <div class="login-card">
            <div class="login-header">
                <div class="lotte-logo" style="justify-content: center; color: #ED1C24;">
                    Happy Moments
                </div>
                <h1 id="loginTitle">ğŸš› ì°¨ëŸ‰ ì…ì°¨ ë“±ë¡ ì‹œìŠ¤í…œ</h1>
                <p id="loginSubtitle">Lotte KF ëŸ¬ì‹œì•„ë²•ì¸</p>
            </div>

            <div class="login-error" id="loginError">
                ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤
            </div>

            <form class="login-form" id="loginForm">
                <div class="form-group">
                    <label for="loginUsername" id="loginUsernameLabel">ì•„ì´ë””</label>
                    <input type="text" id="loginUsername" required autocomplete="username">
                </div>

                <div class="form-group">
                    <label for="loginPassword" id="loginPasswordLabel">ë¹„ë°€ë²ˆí˜¸</label>
                    <input type="password" id="loginPassword" required autocomplete="current-password">
                </div>

                <div class="remember-me">
                    <input type="checkbox" id="rememberMe">
                    <label for="rememberMe" id="rememberMeLabel">ë¡œê·¸ì¸ ìƒíƒœ ìœ ì§€</label>
                </div>

                <button type="submit" class="btn btn-primary btn-full" id="loginBtn">
                    ë¡œê·¸ì¸
                </button>
            </form>
        </div>
    </div>

    <!-- ë©”ì¸ ì•± -->
    <div id="mainApp">
        <div class="container">
            <!-- ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ -->
            <button class="logout-btn" onclick="logout()">ğŸšª ë¡œê·¸ì•„ì›ƒ</button>

            <!-- ì‚¬ìš©ì ì •ë³´ -->
            <div class="user-info" id="userInfo"></div>

            <!-- ì–¸ì–´ ì„ íƒ -->
            <div class="lang-selector">
                <button class="lang-btn active" onclick="switchLanguage('ru')">RUS</button>
                <button class="lang-btn" onclick="switchLanguage('ko')">KOR</button>
            </div>

            <div class="header">
            <div class="lotte-logo">
                <img src="logo.png" alt="Lotte Logo" onerror="this.style.display='none'">
                Happy Moments
            </div>
            <h1>ğŸš› ì°¨ëŸ‰ ì…ì°¨ ë“±ë¡ ì‹œìŠ¤í…œ</h1>
            <div class="subtitle">Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ²ÑŠĞµĞ·Ğ´Ğ° Ñ‚Ñ€Ğ°Ğ½ÑĞ¿Ğ¾Ñ€Ñ‚Ğ° | Vehicle Entry Registration System <span style="font-size: 0.75em; color: #fff; margin-left: 8px;">v0.1</span></div>
            <div class="datetime-display">
                <span class="date" id="currentDate">Loading...</span>
                <span class="time" id="currentTime"></span>
            </div>
        </div>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('register')">ì°¨ëŸ‰ ë“±ë¡</button>
            <button class="tab-btn" onclick="switchTab('list')">ë“±ë¡ í˜„í™©</button>
            <button class="tab-btn" onclick="switchTab('settings')">ì„¤ì •</button>
        </div>

        <!-- ì°¨ëŸ‰ ë“±ë¡ íƒ­ -->
        <div id="register" class="tab-content active">
            <div class="card">
                <h2 style="color: #ED1C24; margin-bottom: 20px;">ğŸš› ì°¨ëŸ‰ ì •ë³´ ë“±ë¡</h2>

                <div class="success-message" id="successMessage">
                    âœ… ì°¨ëŸ‰ ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!
                </div>

                <!-- AI ì´ë¯¸ì§€ ì—…ë¡œë“œ ì„¹ì…˜ -->
                <div class="ai-upload-section">
                    <!-- í´ë¦­ ê°€ëŠ¥í•œ í—¤ë” -->
                    <div class="ai-section-header" onclick="toggleAISection()">
                        <h3>ğŸ¤– AI ìë™ ì…ë ¥</h3>
                        <span class="ai-toggle-icon">â–¼</span>
                    </div>

                    <!-- ì ‘ì—ˆë‹¤ í¼ì³¤ë‹¤ í•˜ëŠ” ì½˜í…ì¸  -->
                    <div class="ai-section-content" id="aiSectionContent">
                        <!-- AI íƒ­ -->
                        <div class="ai-tabs">
                            <button type="button" class="ai-tab-btn active" onclick="switchAITab('image')">ğŸ“¸ ì´ë¯¸ì§€ ì—…ë¡œë“œ</button>
                            <button type="button" class="ai-tab-btn" onclick="switchAITab('text')">ğŸ“ í…ìŠ¤íŠ¸ ë¶™ì—¬ë„£ê¸°</button>
                        </div>

                        <!-- ì´ë¯¸ì§€ ì—…ë¡œë“œ íƒ­ -->
                        <div class="ai-tab-content active" id="imageTab">
                            <div class="upload-area" id="uploadArea">
                                <input type="file" id="imageInput" accept="image/*" style="display: none;">
                                <div class="upload-icon">ğŸ“¸</div>
                                <div class="upload-text">ìœ„ì„ì¥ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”</div>
                                <div class="upload-hint">í´ë¦­í•˜ê±°ë‚˜ ì´ë¯¸ì§€ë¥¼ ë“œë˜ê·¸í•˜ì„¸ìš” (PNG, JPG, PDF)</div>
                            </div>
                            <img id="imagePreview" alt="Preview">
                            <button type="button" class="btn-clear-image" id="clearImageBtn" style="display: none;">ì´ë¯¸ì§€ ì œê±°</button>
                        </div>

                        <!-- í…ìŠ¤íŠ¸ ë¶™ì—¬ë„£ê¸° íƒ­ -->
                        <div class="ai-tab-content" id="textTab">
                            <textarea id="textInput" placeholder="ì´ë©”ì¼ì—ì„œ ë°›ì€ ìœ„ì„ì¥ í…ìŠ¤íŠ¸ë¥¼ ì—¬ê¸°ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”...&#10;&#10;ì˜ˆì‹œ:&#10;Ğ“Ğ°Ğ²Ñ€Ğ¸Ñ Ğ”ĞµĞ½Ğ¸Ñ Ğ’Ğ¸ĞºÑ‚Ğ¾Ñ€Ğ¾Ğ²Ğ¸Ñ‡&#10;ĞŸĞ°ÑĞ¿Ğ¾Ñ€Ñ‚ MC3544098&#10;AX3623-5 / A39101-5&#10;Ğ›ĞĞ¢Ğ¢Ğ•"></textarea>
                            <button type="button" class="btn-extract" onclick="extractFromText()">ì •ë³´ ì¶”ì¶œí•˜ê¸°</button>
                        </div>
                    </div>
                </div>

                <form id="vehicleForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="userName">ì…ë ¥ì ì´ë¦„ *</label>
                            <select id="userName" required>
                                <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="entryDate">ì…ì°¨ ë‚ ì§œ *</label>
                            <input type="date" id="entryDate" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="clientName">ê±°ë˜ì²˜ëª… *</label>
                            <input type="text" id="clientName" placeholder="ê±°ë˜ì²˜ëª… ì…ë ¥" required>
                        </div>

                        <div class="form-group">
                            <label for="orderNumber">ì£¼ë¬¸ë²ˆí˜¸</label>
                            <input type="text" id="orderNumber" placeholder="ì£¼ë¬¸ë²ˆí˜¸ ì…ë ¥">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="headNumber">í—¤ë“œ ë²ˆí˜¸ *</label>
                            <input type="text" id="headNumber" placeholder="ì»¨í…Œì´ë„ˆ í—¤ë“œ ë²ˆí˜¸" required>
                        </div>

                        <div class="form-group">
                            <label for="trailerNumber">íŠ¸ë ˆì¼ëŸ¬ ë²ˆí˜¸ *</label>
                            <input type="text" id="trailerNumber" placeholder="íŠ¸ë ˆì¼ëŸ¬ ë²ˆí˜¸" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="driverName">ìš´ì „ì ì´ë¦„ *</label>
                            <input type="text" id="driverName" placeholder="ìš´ì „ì ì´ë¦„" required>
                        </div>

                        <div class="form-group">
                            <label for="driverPassport">ìš´ì „ì ì—¬ê¶Œë²ˆí˜¸ *</label>
                            <input type="text" id="driverPassport" placeholder="ì—¬ê¶Œë²ˆí˜¸" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="driverPhone">ìš´ì „ì ì „í™”ë²ˆí˜¸</label>
                            <input type="tel" id="driverPhone" placeholder="+7 XXX XXX XX XX">
                        </div>

                        <div class="form-group">
                            <label for="entryTime">ì…ì°¨ ì˜ˆì • ì‹œê°</label>
                            <input type="time" id="entryTime" min="08:00" max="20:00">
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="checkbox-group">
                            <input type="checkbox" id="entryCompleted">
                            <label for="entryCompleted">ì…ì°¨ ì™„ë£Œ</label>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary btn-full" id="submitBtn">
                        ë“±ë¡í•˜ê¸°
                    </button>
                </form>
            </div>
        </div>

        <!-- ë“±ë¡ í˜„í™© íƒ­ -->
        <div id="list" class="tab-content">
            <div class="card">
                <h2 style="color: #ED1C24; margin-bottom: 20px;">ğŸ“‹ ë“±ë¡ í˜„í™©</h2>

                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="ğŸ” ê²€ìƒ‰ (ì°¨ëŸ‰ë²ˆí˜¸, ê±°ë˜ì²˜ëª…, ì£¼ë¬¸ë²ˆí˜¸, ìš´ì „ìëª…)">
                </div>

                <div class="filter-tabs">
                    <button class="filter-btn active" onclick="filterVehicles('all')">ì „ì²´</button>
                    <button class="filter-btn" onclick="filterVehicles('today')">ì˜¤ëŠ˜</button>
                    <button class="filter-btn" onclick="filterVehicles('pending')">ì…ì°¨ ëŒ€ê¸°</button>
                    <button class="filter-btn" onclick="filterVehicles('completed')">ì…ì°¨ ì™„ë£Œ</button>
                </div>

                <div class="export-section">
                    <button class="export-btn" onclick="exportToCSV()">
                        <span>ğŸ“Š</span>
                        <span id="exportBtnText">CSV ë‚´ë³´ë‚´ê¸°</span>
                    </button>
                </div>

                <div class="vehicle-list" id="vehicleList">
                    <!-- ì°¨ëŸ‰ ëª©ë¡ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>

        <!-- ì„¤ì • íƒ­ -->
        <div id="settings" class="tab-content">
            <div class="card">
                <h2 style="color: #ED1C24; margin-bottom: 20px;">âš™ï¸ ì„¤ì •</h2>

                <div class="form-group">
                    <label>Google Sheets URL</label>
                    <input type="text" id="googleSheetUrl" placeholder="Google Apps Script URL ì…ë ¥">
                </div>

                <h3 style="margin-top: 30px; color: #ED1C24; font-size: 1.1rem;">ğŸ‘¥ ì‚¬ìš©ì ê´€ë¦¬</h3>
                <div id="userManagement"></div>

                <button class="btn btn-primary btn-full" onclick="saveSettings()" style="margin-top: 20px;">
                    ğŸ’¾ ì„¤ì • ì €ì¥
                </button>
            </div>
        </div>
    </div>
    </div>

    <!-- ì²˜ë¦¬ ì¤‘ ì˜¤ë²„ë ˆì´ -->
    <div class="processing-overlay" id="processingOverlay">
        <div class="spinner"></div>
        <div class="processing-text">ì´ë¯¸ì§€ ë¶„ì„ ì¤‘...</div>
    </div>

    <!-- Tesseract.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>

    <script>
        // ë²ˆì—­ ê°ì²´
        const TRANSLATIONS = {
            ru: {
                // í—¤ë”
                title: 'ğŸš› Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ²ÑŠĞµĞ·Ğ´Ğ° Ñ‚Ñ€Ğ°Ğ½ÑĞ¿Ğ¾Ñ€Ñ‚Ğ°',
                subtitle: 'Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ²ÑŠĞµĞ·Ğ´Ğ° Ñ‚Ñ€Ğ°Ğ½ÑĞ¿Ğ¾Ñ€Ñ‚Ğ° | Vehicle Entry Registration System',

                // íƒ­
                tabRegister: 'Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ',
                tabList: 'Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ',
                tabSettings: 'ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸',

                // ì°¨ëŸ‰ ë“±ë¡ í¼
                registerTitle: 'ğŸš› Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ñ‚Ñ€Ğ°Ğ½ÑĞ¿Ğ¾Ñ€Ñ‚Ğ°',
                userName: 'Ğ˜Ğ¼Ñ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ° *',
                selectPlaceholder: 'Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ',
                entryDate: 'Ğ”Ğ°Ñ‚Ğ° Ğ²ÑŠĞµĞ·Ğ´Ğ° *',
                clientName: 'ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ° *',
                clientPlaceholder: 'Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ°',
                orderNumber: 'ĞĞ¾Ğ¼ĞµÑ€ Ğ·Ğ°ĞºĞ°Ğ·Ğ°',
                orderPlaceholder: 'Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ½Ğ¾Ğ¼ĞµÑ€ Ğ·Ğ°ĞºĞ°Ğ·Ğ°',
                headNumber: 'ĞĞ¾Ğ¼ĞµÑ€ Ğ³Ğ¾Ğ»Ğ¾Ğ²Ñ‹ *',
                headPlaceholder: 'ĞĞ¾Ğ¼ĞµÑ€ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ° Ğ³Ğ¾Ğ»Ğ¾Ğ²Ñ‹',
                trailerNumber: 'ĞĞ¾Ğ¼ĞµÑ€ Ğ¿Ñ€Ğ¸Ñ†ĞµĞ¿Ğ° *',
                trailerPlaceholder: 'ĞĞ¾Ğ¼ĞµÑ€ Ğ¿Ñ€Ğ¸Ñ†ĞµĞ¿Ğ°',
                driverName: 'Ğ˜Ğ¼Ñ Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»Ñ *',
                driverNamePlaceholder: 'Ğ˜Ğ¼Ñ Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»Ñ',
                driverPassport: 'ĞĞ¾Ğ¼ĞµÑ€ Ğ¿Ğ°ÑĞ¿Ğ¾Ñ€Ñ‚Ğ° *',
                passportPlaceholder: 'ĞĞ¾Ğ¼ĞµÑ€ Ğ¿Ğ°ÑĞ¿Ğ¾Ñ€Ñ‚Ğ°',
                driverPhone: 'Ğ¢ĞµĞ»ĞµÑ„Ğ¾Ğ½ Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»Ñ',
                phonePlaceholder: '+7 XXX XXX XX XX',
                entryTime: 'Ğ’Ñ€ĞµĞ¼Ñ Ğ²ÑŠĞµĞ·Ğ´Ğ°',
                entryCompleted: 'Ğ’ÑŠĞµĞ·Ğ´ Ğ·Ğ°Ğ²ĞµÑ€ÑˆÑ‘Ğ½',
                submitBtn: 'Ğ—Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ',
                successMessage: 'âœ… Ğ¢Ñ€Ğ°Ğ½ÑĞ¿Ğ¾Ñ€Ñ‚ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ Ğ·Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½!',

                // ë“±ë¡ í˜„í™©
                listTitle: 'ğŸ“‹ Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸',
                searchPlaceholder: 'ğŸ” ĞŸĞ¾Ğ¸ÑĞº (Ğ½Ğ¾Ğ¼ĞµÑ€ Ğ°Ğ²Ñ‚Ğ¾, ĞºĞ»Ğ¸ĞµĞ½Ñ‚, Ğ·Ğ°ĞºĞ°Ğ·, Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒ)',
                filterAll: 'Ğ’ÑĞµ',
                filterToday: 'Ğ¡ĞµĞ³Ğ¾Ğ´Ğ½Ñ',
                filterPending: 'ĞĞ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ',
                filterCompleted: 'Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¾',
                exportBtn: 'Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ² CSV',
                noVehicles: 'ĞĞµÑ‚ Ğ·Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ñ… Ñ‚Ñ€Ğ°Ğ½ÑĞ¿Ğ¾Ñ€Ñ‚Ğ¾Ğ²',
                statusCompleted: 'Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¾',
                statusPending: 'ĞĞ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ',
                btnToggleComplete: 'Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ½Ğ° Ğ¾Ğ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ',
                btnTogglePending: 'Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ½Ğ° Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¾',
                btnEdit: 'Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ',
                btnDelete: 'Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ',
                registeredBy: 'Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ',

                // ì„¤ì •
                settingsTitle: 'âš™ï¸ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸',
                googleSheetUrl: 'Google Sheets URL',
                googleSheetPlaceholder: 'Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ URL Google Apps Script',
                userManagement: 'ğŸ‘¥ Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑĞ¼Ğ¸',
                btnSave: 'ğŸ’¾ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸',

                // ë©”ì‹œì§€
                passwordPrompt: 'Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ°:',
                passwordWrong: 'ĞĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¹ Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ',
                deleteConfirm: 'Ğ’Ñ‹ ÑƒĞ²ĞµÑ€ĞµĞ½Ñ‹, Ñ‡Ñ‚Ğ¾ Ñ…Ğ¾Ñ‚Ğ¸Ñ‚Ğµ ÑƒĞ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ?',
                deleteOwnOnly: 'Ğ’Ñ‹ Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ ÑƒĞ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ÑĞ²Ğ¾Ğ¸ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸',
                editOwnOnly: 'Ğ’Ñ‹ Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ÑĞ²Ğ¾Ğ¸ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸',
                settingsSaved: 'ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ñ‹',

                // AI ì´ë¯¸ì§€ ì—…ë¡œë“œ
                aiAutoFill: 'ğŸ¤– AI ĞĞ²Ñ‚Ğ¾Ğ·Ğ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ',
                aiTabImage: 'ğŸ“¸ Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ',
                aiTabText: 'ğŸ“ Ğ’ÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ñ‚ĞµĞºÑÑ‚',
                uploadImage: 'Ğ—Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚Ğµ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ Ğ´Ğ¾Ğ²ĞµÑ€ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸',
                uploadHint: 'ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ Ğ¸Ğ»Ğ¸ Ğ¿ĞµÑ€ĞµÑ‚Ğ°Ñ‰Ğ¸Ñ‚Ğµ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ (PNG, JPG, PDF)',
                textPlaceholder: 'Ğ’ÑÑ‚Ğ°Ğ²ÑŒÑ‚Ğµ Ñ‚ĞµĞºÑÑ‚ Ğ´Ğ¾Ğ²ĞµÑ€ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¸Ğ· email...\n\nĞŸÑ€Ğ¸Ğ¼ĞµÑ€:\nĞ“Ğ°Ğ²Ñ€Ğ¸Ñ Ğ”ĞµĞ½Ğ¸Ñ Ğ’Ğ¸ĞºÑ‚Ğ¾Ñ€Ğ¾Ğ²Ğ¸Ñ‡\nĞŸĞ°ÑĞ¿Ğ¾Ñ€Ñ‚ MC3544098\nAX3623-5 / A39101-5\nĞ›ĞĞ¢Ğ¢Ğ•',
                btnExtract: 'Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ÑŒ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ',
                clearImage: 'Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ',
                processing: 'ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ...',
                extractSuccess: 'âœ… Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ°!',
                extractError: 'âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğµ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ',

                // ë¡œê·¸ì¸
                loginTitle: 'ğŸš› Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ²ÑŠĞµĞ·Ğ´Ğ° Ñ‚Ñ€Ğ°Ğ½ÑĞ¿Ğ¾Ñ€Ñ‚Ğ°',
                loginSubtitle: 'Lotte KF Ğ Ğ¾ÑÑĞ¸Ğ¹ÑĞºĞ¸Ğ¹ Ñ„Ğ¸Ğ»Ğ¸Ğ°Ğ»',
                username: 'Ğ›Ğ¾Ğ³Ğ¸Ğ½',
                password: 'ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ',
                rememberMe: 'Ğ—Ğ°Ğ¿Ğ¾Ğ¼Ğ½Ğ¸Ñ‚ÑŒ Ğ¼ĞµĞ½Ñ',
                loginBtn: 'Ğ’Ğ¾Ğ¹Ñ‚Ğ¸',
                loginError: 'ĞĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¹ Ğ»Ğ¾Ğ³Ğ¸Ğ½ Ğ¸Ğ»Ğ¸ Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ',
                logout: 'ğŸšª Ğ’Ñ‹Ğ¹Ñ‚Ğ¸',
                loggedInAs: 'Ğ’Ğ¾ÑˆĞ»Ğ¸ ĞºĞ°Ğº'
            },
            ko: {
                // í—¤ë”
                title: 'ğŸš› ì°¨ëŸ‰ ì…ì°¨ ë“±ë¡ ì‹œìŠ¤í…œ',
                subtitle: 'Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ²ÑŠĞµĞ·Ğ´Ğ° Ñ‚Ñ€Ğ°Ğ½ÑĞ¿Ğ¾Ñ€Ñ‚Ğ° | Vehicle Entry Registration System',

                // íƒ­
                tabRegister: 'ì°¨ëŸ‰ ë“±ë¡',
                tabList: 'ë“±ë¡ í˜„í™©',
                tabSettings: 'ì„¤ì •',

                // ì°¨ëŸ‰ ë“±ë¡ í¼
                registerTitle: 'ğŸš› ì°¨ëŸ‰ ì •ë³´ ë“±ë¡',
                userName: 'ì…ë ¥ì ì´ë¦„ *',
                selectPlaceholder: 'ì„ íƒí•˜ì„¸ìš”',
                entryDate: 'ì…ì°¨ ë‚ ì§œ *',
                clientName: 'ê±°ë˜ì²˜ëª… *',
                clientPlaceholder: 'ê±°ë˜ì²˜ëª… ì…ë ¥',
                orderNumber: 'ì£¼ë¬¸ë²ˆí˜¸',
                orderPlaceholder: 'ì£¼ë¬¸ë²ˆí˜¸ ì…ë ¥',
                headNumber: 'í—¤ë“œ ë²ˆí˜¸ *',
                headPlaceholder: 'ì»¨í…Œì´ë„ˆ í—¤ë“œ ë²ˆí˜¸',
                trailerNumber: 'íŠ¸ë ˆì¼ëŸ¬ ë²ˆí˜¸ *',
                trailerPlaceholder: 'íŠ¸ë ˆì¼ëŸ¬ ë²ˆí˜¸',
                driverName: 'ìš´ì „ì ì´ë¦„ *',
                driverNamePlaceholder: 'ìš´ì „ì ì´ë¦„',
                driverPassport: 'ìš´ì „ì ì—¬ê¶Œë²ˆí˜¸ *',
                passportPlaceholder: 'ì—¬ê¶Œë²ˆí˜¸',
                driverPhone: 'ìš´ì „ì ì „í™”ë²ˆí˜¸',
                phonePlaceholder: '+7 XXX XXX XX XX',
                entryTime: 'ì…ì°¨ ì˜ˆì • ì‹œê°',
                entryCompleted: 'ì…ì°¨ ì™„ë£Œ',
                submitBtn: 'ë“±ë¡í•˜ê¸°',
                successMessage: 'âœ… ì°¨ëŸ‰ ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!',

                // ë“±ë¡ í˜„í™©
                listTitle: 'ğŸ“‹ ë“±ë¡ í˜„í™©',
                searchPlaceholder: 'ğŸ” ê²€ìƒ‰ (ì°¨ëŸ‰ë²ˆí˜¸, ê±°ë˜ì²˜ëª…, ì£¼ë¬¸ë²ˆí˜¸, ìš´ì „ìëª…)',
                filterAll: 'ì „ì²´',
                filterToday: 'ì˜¤ëŠ˜',
                filterPending: 'ì…ì°¨ ëŒ€ê¸°',
                filterCompleted: 'ì…ì°¨ ì™„ë£Œ',
                exportBtn: 'CSV ë‚´ë³´ë‚´ê¸°',
                noVehicles: 'ë“±ë¡ëœ ì°¨ëŸ‰ì´ ì—†ìŠµë‹ˆë‹¤',
                statusCompleted: 'ì…ì°¨ì™„ë£Œ',
                statusPending: 'ì…ì°¨ëŒ€ê¸°',
                btnToggleComplete: 'ëŒ€ê¸°ë¡œ ë³€ê²½',
                btnTogglePending: 'ì™„ë£Œë¡œ ë³€ê²½',
                btnEdit: 'ìˆ˜ì •',
                btnDelete: 'ì‚­ì œ',
                registeredBy: 'ë“±ë¡',

                // ì„¤ì •
                settingsTitle: 'âš™ï¸ ì„¤ì •',
                googleSheetUrl: 'Google Sheets URL',
                googleSheetPlaceholder: 'Google Apps Script URL ì…ë ¥',
                userManagement: 'ğŸ‘¥ ì‚¬ìš©ì ê´€ë¦¬',
                btnSave: 'ğŸ’¾ ì„¤ì • ì €ì¥',

                // ë©”ì‹œì§€
                passwordPrompt: 'ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”:',
                passwordWrong: 'ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤',
                deleteConfirm: 'ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?',
                deleteOwnOnly: 'ë³¸ì¸ì´ ë“±ë¡í•œ ì°¨ëŸ‰ë§Œ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤',
                editOwnOnly: 'ë³¸ì¸ì´ ë“±ë¡í•œ ì°¨ëŸ‰ë§Œ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤',
                settingsSaved: 'ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤',

                // AI ì´ë¯¸ì§€ ì—…ë¡œë“œ
                aiAutoFill: 'ğŸ¤– AI ìë™ ì…ë ¥',
                aiTabImage: 'ğŸ“¸ ì´ë¯¸ì§€ ì—…ë¡œë“œ',
                aiTabText: 'ğŸ“ í…ìŠ¤íŠ¸ ë¶™ì—¬ë„£ê¸°',
                uploadImage: 'ìœ„ì„ì¥ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”',
                uploadHint: 'í´ë¦­í•˜ê±°ë‚˜ ì´ë¯¸ì§€ë¥¼ ë“œë˜ê·¸í•˜ì„¸ìš” (PNG, JPG, PDF)',
                textPlaceholder: 'ì´ë©”ì¼ì—ì„œ ë°›ì€ ìœ„ì„ì¥ í…ìŠ¤íŠ¸ë¥¼ ì—¬ê¸°ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”...\n\nì˜ˆì‹œ:\nĞ“Ğ°Ğ²Ñ€Ğ¸Ñ Ğ”ĞµĞ½Ğ¸Ñ Ğ’Ğ¸ĞºÑ‚Ğ¾Ñ€Ğ¾Ğ²Ğ¸Ñ‡\nĞŸĞ°ÑĞ¿Ğ¾Ñ€Ñ‚ MC3544098\nAX3623-5 / A39101-5\nĞ›ĞĞ¢Ğ¢Ğ•',
                btnExtract: 'ì •ë³´ ì¶”ì¶œí•˜ê¸°',
                clearImage: 'ì´ë¯¸ì§€ ì œê±°',
                processing: 'ì´ë¯¸ì§€ ë¶„ì„ ì¤‘...',
                extractSuccess: 'âœ… ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ì¶”ì¶œë˜ì—ˆìŠµë‹ˆë‹¤!',
                extractError: 'âŒ ì´ë¯¸ì§€ ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤',

                // ë¡œê·¸ì¸
                loginTitle: 'ğŸš› ì°¨ëŸ‰ ì…ì°¨ ë“±ë¡ ì‹œìŠ¤í…œ',
                loginSubtitle: 'Lotte KF ëŸ¬ì‹œì•„ë²•ì¸',
                username: 'ì•„ì´ë””',
                password: 'ë¹„ë°€ë²ˆí˜¸',
                rememberMe: 'ë¡œê·¸ì¸ ìƒíƒœ ìœ ì§€',
                loginBtn: 'ë¡œê·¸ì¸',
                loginError: 'ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤',
                logout: 'ğŸšª ë¡œê·¸ì•„ì›ƒ',
                loggedInAs: 'ë¡œê·¸ì¸:'
            }
        };

        let currentLang = 'ru'; // ê¸°ë³¸ ì–¸ì–´: ëŸ¬ì‹œì•„ì–´
        let dateTimeInterval = null; // ë‚ ì§œ/ì‹œê°„ ì—…ë°ì´íŠ¸ ì¸í„°ë²Œ

        const STORAGE_KEYS = {
            vehicles: 'vehicleRegistrations',
            settings: 'vehicleSettings',
            users: 'vehicleUsers',
            language: 'preferredLanguage',
            learningData: 'ocrLearningData',
            lastOcrExtraction: 'lastOcrExtraction',
            accounts: 'userAccounts',
            currentUser: 'currentUser',
            rememberMe: 'rememberMe'
        };

        // ê¸°ë³¸ ì‚¬ìš©ì ëª©ë¡
        const DEFAULT_USERS = [
            { name: 'ì¡°ì„±ë¯¼', role: 'ì˜ì—…íŒ€', isActive: true },
            { name: 'ê¹€ì˜ì—…', role: 'ì˜ì—…íŒ€', isActive: true },
            { name: 'ì´ë¬¼ë¥˜', role: 'ë¬¼ë¥˜íŒ€', isActive: true },
            { name: 'ë°•ì°½ê³ ', role: 'ì°½ê³ ', isActive: true },
            { name: 'ìµœê²½ë¹„', role: 'ê²½ë¹„', isActive: true }
        ];

        // ========== ê³„ì • ê´€ë¦¬ ë° ì¸ì¦ ==========

        // ê°„ë‹¨í•œ ë¹„ë°€ë²ˆí˜¸ í•´ì‹± (Base64 ì¸ì½”ë”© + Salt)
        function hashPassword(password) {
            const salt = 'LotteKF2025';
            return btoa(salt + password + salt);
        }

        // ê³„ì • ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
        function loadAccounts() {
            const accounts = localStorage.getItem(STORAGE_KEYS.accounts);
            if (accounts) {
                return JSON.parse(accounts);
            }

            // ê¸°ë³¸ ê´€ë¦¬ì ê³„ì • ë° ì§ì› ê³„ì • ìƒì„±
            const defaultAccounts = [
                {
                    username: 'admin',
                    password: hashPassword('1234'),
                    name: 'ê´€ë¦¬ì',
                    role: 'ê´€ë¦¬ì',
                    isAdmin: true
                },
                {
                    username: 'cho',
                    password: hashPassword('1234'),
                    name: 'ì¡°ì„±ë¯¼',
                    role: 'ì˜ì—…íŒ€',
                    isAdmin: false
                }
            ];

            saveAccounts(defaultAccounts);
            return defaultAccounts;
        }

        // ê³„ì • ë°ì´í„° ì €ì¥
        function saveAccounts(accounts) {
            localStorage.setItem(STORAGE_KEYS.accounts, JSON.stringify(accounts));
        }

        // ë¡œê·¸ì¸ ì²˜ë¦¬
        function handleLogin(event) {
            event.preventDefault();

            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;
            const rememberMe = document.getElementById('rememberMe').checked;

            const accounts = loadAccounts();
            const hashedPassword = hashPassword(password);

            const account = accounts.find(acc =>
                acc.username === username && acc.password === hashedPassword
            );

            if (account) {
                // ë¡œê·¸ì¸ ì„±ê³µ
                const currentUser = {
                    username: account.username,
                    name: account.name,
                    role: account.role,
                    isAdmin: account.isAdmin || false
                };

                localStorage.setItem(STORAGE_KEYS.currentUser, JSON.stringify(currentUser));

                if (rememberMe) {
                    localStorage.setItem(STORAGE_KEYS.rememberMe, 'true');
                } else {
                    localStorage.removeItem(STORAGE_KEYS.rememberMe);
                }

                // ì‚¬ìš©ì ì„ íƒ ëª©ë¡ì— ìë™ ì„ íƒ
                localStorage.setItem('lastSelectedUser', account.name);

                showMainApp();
            } else {
                // ë¡œê·¸ì¸ ì‹¤íŒ¨
                const loginError = document.getElementById('loginError');
                loginError.classList.add('show');
                setTimeout(() => loginError.classList.remove('show'), 3000);
            }
        }

        // ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬
        function logout() {
            const t = TRANSLATIONS[currentLang];

            if (confirm('ì •ë§ ë¡œê·¸ì•„ì›ƒí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                localStorage.removeItem(STORAGE_KEYS.currentUser);

                const rememberMe = localStorage.getItem(STORAGE_KEYS.rememberMe);
                if (!rememberMe) {
                    localStorage.removeItem('lastSelectedUser');
                }

                showLoginPage();
            }
        }

        // ë¡œê·¸ì¸ í˜ì´ì§€ í‘œì‹œ
        function showLoginPage() {
            document.getElementById('loginPage').style.display = 'flex';
            document.getElementById('mainApp').classList.remove('show');
            document.getElementById('loginUsername').value = '';
            document.getElementById('loginPassword').value = '';
        }

        // ë©”ì¸ ì•± í‘œì‹œ
        function showMainApp() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('mainApp').classList.add('show');

            const currentUser = JSON.parse(localStorage.getItem(STORAGE_KEYS.currentUser));
            const t = TRANSLATIONS[currentLang];

            document.getElementById('userInfo').textContent =
                `${t.loggedInAs}: ${currentUser.name} (${currentUser.role})`;

            // ì–¸ì–´ ì—…ë°ì´íŠ¸ (ëª¨ë“  UI ìš”ì†Œ ë²ˆì—­)
            updateLanguage();

            // ì‚¬ìš©ì ì„ íƒ ëª©ë¡ ë Œë”ë§
            renderUserSelect();

            // ë‚ ì§œ/ì‹œê°„ ì—…ë°ì´íŠ¸ ì‹œì‘
            if (dateTimeInterval) {
                clearInterval(dateTimeInterval);
            }
            updateDateTime();
            dateTimeInterval = setInterval(updateDateTime, 1000);
        }

        // ì´ˆê¸° ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
        function checkLoginStatus() {
            const currentUser = localStorage.getItem(STORAGE_KEYS.currentUser);

            if (currentUser) {
                showMainApp();
            } else {
                showLoginPage();
            }
        }

        // ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸°
        function loadSettings() {
            const settings = localStorage.getItem(STORAGE_KEYS.settings);
            if (settings) {
                return JSON.parse(settings);
            }
            return {
                googleSheetUrl: '',
                users: DEFAULT_USERS
            };
        }

        // ì„¤ì • ì €ì¥
        function saveSettings() {
            const settings = {
                googleSheetUrl: document.getElementById('googleSheetUrl').value,
                users: loadSettings().users
            };
            localStorage.setItem(STORAGE_KEYS.settings, JSON.stringify(settings));
            alert(TRANSLATIONS[currentLang].settingsSaved);
        }

        // ì°¨ëŸ‰ ë“±ë¡ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
        function loadVehicles() {
            const vehicles = localStorage.getItem(STORAGE_KEYS.vehicles);
            return vehicles ? JSON.parse(vehicles) : [];
        }

        // ì°¨ëŸ‰ ë“±ë¡ ë°ì´í„° ì €ì¥
        function saveVehicles(vehicles) {
            localStorage.setItem(STORAGE_KEYS.vehicles, JSON.stringify(vehicles));
        }

        // OCR í•™ìŠµ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
        function loadLearningData() {
            const data = localStorage.getItem(STORAGE_KEYS.learningData);
            return data ? JSON.parse(data) : {
                clientMappings: {},    // í…ìŠ¤íŠ¸ íŒ¨í„´ -> ê±°ë˜ì²˜ëª…
                orderMappings: {},     // í…ìŠ¤íŠ¸ íŒ¨í„´ -> ì£¼ë¬¸ë²ˆí˜¸
                nameMappings: {},      // í…ìŠ¤íŠ¸ íŒ¨í„´ -> ìš´ì „ìëª…
                passportMappings: {},  // í…ìŠ¤íŠ¸ íŒ¨í„´ -> ì—¬ê¶Œë²ˆí˜¸
                totalExtractions: 0,   // ì´ ì¶”ì¶œ íšŸìˆ˜
                corrections: 0         // ì´ ìˆ˜ì • íšŸìˆ˜
            };
        }

        // OCR í•™ìŠµ ë°ì´í„° ì €ì¥
        function saveLearningData(data) {
            localStorage.setItem(STORAGE_KEYS.learningData, JSON.stringify(data));
        }

        // í•™ìŠµ ë°ì´í„° ì—…ë°ì´íŠ¸ (í¼ ì œì¶œ ì‹œ í˜¸ì¶œ)
        function updateLearningData(originalText, extractedData, finalData) {
            const learningData = loadLearningData();
            learningData.totalExtractions++;

            // ê±°ë˜ì²˜ëª… í•™ìŠµ
            if (extractedData.clientName !== finalData.clientName && finalData.clientName) {
                learningData.corrections++;
                // ì›ë³¸ í…ìŠ¤íŠ¸ì—ì„œ í‚¤ì›Œë“œ ì¶”ì¶œ
                const keywords = extractClientKeywords(originalText);
                keywords.forEach(keyword => {
                    learningData.clientMappings[keyword] = finalData.clientName;
                });
            }

            // ì£¼ë¬¸ë²ˆí˜¸ í•™ìŠµ
            if (extractedData.orderNumber !== finalData.orderNumber && finalData.orderNumber) {
                learningData.corrections++;
                const orderPattern = extractOrderPattern(originalText, finalData.orderNumber);
                if (orderPattern) {
                    learningData.orderMappings[orderPattern] = finalData.orderNumber;
                }
            }

            // ìš´ì „ìëª… í•™ìŠµ
            if (extractedData.driverName !== finalData.driverName && finalData.driverName) {
                learningData.corrections++;
                learningData.nameMappings[extractedData.driverName] = finalData.driverName;
            }

            // ì—¬ê¶Œë²ˆí˜¸ í•™ìŠµ
            if (extractedData.driverPassport !== finalData.driverPassport && finalData.driverPassport) {
                learningData.corrections++;
                learningData.passportMappings[extractedData.driverPassport] = finalData.driverPassport;
            }

            saveLearningData(learningData);
            console.log('í•™ìŠµ ë°ì´í„° ì—…ë°ì´íŠ¸:', learningData);
        }

        // ê±°ë˜ì²˜ëª… í‚¤ì›Œë“œ ì¶”ì¶œ
        function extractClientKeywords(text) {
            const keywords = [];
            // ëŒ€ë¬¸ì ë‹¨ì–´ ì¶”ì¶œ
            const upperWords = text.match(/[A-ZĞ-Ğ¯Ğ]{3,}/g);
            if (upperWords) {
                keywords.push(...upperWords);
            }
            return keywords;
        }

        // ì£¼ë¬¸ë²ˆí˜¸ íŒ¨í„´ ì¶”ì¶œ
        function extractOrderPattern(text, orderNumber) {
            // ì£¼ë¬¸ë²ˆí˜¸ ì£¼ë³€ í…ìŠ¤íŠ¸ íŒ¨í„´ ì¶”ì¶œ
            const index = text.indexOf(orderNumber);
            if (index > -1) {
                return text.substring(Math.max(0, index - 20), index + orderNumber.length + 20).trim();
            }
            return null;
        }

        // ì‚¬ìš©ì ëª©ë¡ ë Œë”ë§
        function renderUserSelect() {
            const settings = loadSettings();
            const select = document.getElementById('userName');
            select.innerHTML = '<option value="">ì„ íƒí•˜ì„¸ìš”</option>';

            settings.users.filter(u => u.isActive).forEach(user => {
                const option = document.createElement('option');
                option.value = user.name;
                option.textContent = `${user.name} (${user.role})`;
                select.appendChild(option);
            });

            // ë§ˆì§€ë§‰ ì„ íƒ ì‚¬ìš©ì ë³µì›
            const lastUser = localStorage.getItem('lastSelectedUser');
            if (lastUser) {
                select.value = lastUser;
            }
        }

        // ì°¨ëŸ‰ ë“±ë¡ í¼ ì œì¶œ
        document.getElementById('vehicleForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const userName = document.getElementById('userName').value;
            const finalData = {
                clientName: document.getElementById('clientName').value,
                orderNumber: document.getElementById('orderNumber').value,
                headNumber: document.getElementById('headNumber').value,
                trailerNumber: document.getElementById('trailerNumber').value,
                driverName: document.getElementById('driverName').value,
                driverPassport: document.getElementById('driverPassport').value,
                driverPhone: document.getElementById('driverPhone').value,
                entryTime: document.getElementById('entryTime').value
            };

            const vehicle = {
                id: Date.now(),
                registeredBy: userName,
                registeredAt: new Date().toISOString(),
                entryDate: document.getElementById('entryDate').value,
                ...finalData,
                entryCompleted: document.getElementById('entryCompleted').checked
            };

            // OCR í•™ìŠµ ë°ì´í„° ì—…ë°ì´íŠ¸
            const lastExtraction = localStorage.getItem(STORAGE_KEYS.lastOcrExtraction);
            if (lastExtraction) {
                const { originalText, extractedData } = JSON.parse(lastExtraction);
                updateLearningData(originalText, extractedData, finalData);
                // í•™ìŠµ í›„ ì‚­ì œ
                localStorage.removeItem(STORAGE_KEYS.lastOcrExtraction);
            }

            const vehicles = loadVehicles();
            vehicles.push(vehicle);
            saveVehicles(vehicles);

            // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
            const successMsg = document.getElementById('successMessage');
            successMsg.classList.add('show');
            setTimeout(() => successMsg.classList.remove('show'), 3000);

            // í¼ ì´ˆê¸°í™”
            document.getElementById('vehicleForm').reset();
            document.getElementById('userName').value = userName;
            localStorage.setItem('lastSelectedUser', userName);

            // Google Sheets ë™ê¸°í™” (ìˆëŠ” ê²½ìš°)
            syncToGoogleSheet(vehicle);
        });

        // ì°¨ëŸ‰ ëª©ë¡ ë Œë”ë§
        function renderVehicleList(filter = 'all') {
            const vehicles = loadVehicles();
            const container = document.getElementById('vehicleList');
            const searchQuery = document.getElementById('searchInput').value.toLowerCase();

            let filteredVehicles = vehicles;

            // í•„í„° ì ìš©
            if (filter === 'today') {
                const today = new Date().toISOString().split('T')[0];
                filteredVehicles = vehicles.filter(v => v.entryDate === today);
            } else if (filter === 'pending') {
                filteredVehicles = vehicles.filter(v => !v.entryCompleted);
            } else if (filter === 'completed') {
                filteredVehicles = vehicles.filter(v => v.entryCompleted);
            }

            // ê²€ìƒ‰ì–´ ì ìš©
            if (searchQuery) {
                filteredVehicles = filteredVehicles.filter(v =>
                    v.headNumber.toLowerCase().includes(searchQuery) ||
                    v.trailerNumber.toLowerCase().includes(searchQuery) ||
                    v.clientName.toLowerCase().includes(searchQuery) ||
                    v.orderNumber.toLowerCase().includes(searchQuery) ||
                    v.driverName.toLowerCase().includes(searchQuery)
                );
            }

            // ë‚ ì§œì™€ ì‹œê°„ë³„ë¡œ ì •ë ¬ (ì…ì°¨ë‚ ì§œ + ì…ì°¨ì˜ˆì •ì‹œê°)
            // ì…ì°¨ ì˜ˆì • ì‹œê°ì´ ì—†ìœ¼ë©´ 20:00ìœ¼ë¡œ ê°„ì£¼
            filteredVehicles.sort((a, b) => {
                const timeA = a.entryTime || '20:00';
                const timeB = b.entryTime || '20:00';
                const dateTimeA = new Date(`${a.entryDate}T${timeA}`);
                const dateTimeB = new Date(`${b.entryDate}T${timeB}`);
                return dateTimeA - dateTimeB;
            });

            const t = TRANSLATIONS[currentLang];

            if (filteredVehicles.length === 0) {
                container.innerHTML = `<p style="text-align: center; color: #999; padding: 40px;">${t.noVehicles}</p>`;
                return;
            }

            container.innerHTML = filteredVehicles.map(vehicle => `
                <div class="vehicle-item ${vehicle.entryCompleted ? 'completed' : 'pending'}">
                    <div class="vehicle-header">
                        <div class="vehicle-info">
                            <div class="vehicle-number">
                                ğŸš› ${vehicle.headNumber} / ${vehicle.trailerNumber}
                            </div>
                            <div class="vehicle-details">
                                ğŸ“… ${vehicle.entryDate} ${vehicle.entryTime} |
                                ğŸ¢ ${vehicle.clientName} |
                                ğŸ“¦ ${vehicle.orderNumber}<br>
                                ğŸ‘¤ ${vehicle.driverName} |
                                ğŸ“± ${vehicle.driverPhone} |
                                ğŸ›‚ ${vehicle.driverPassport}<br>
                                <span style="color: #999; font-size: 0.85rem;">${t.registeredBy}: ${vehicle.registeredBy} (${new Date(vehicle.registeredAt).toLocaleString('ko-KR')})</span>
                            </div>
                        </div>
                        <span class="status-badge ${vehicle.entryCompleted ? 'status-completed' : 'status-pending'}">
                            ${vehicle.entryCompleted ? t.statusCompleted : t.statusPending}
                        </span>
                    </div>
                    <div class="vehicle-actions">
                        <button class="btn btn-small btn-success" onclick="toggleEntryStatus(${vehicle.id})">
                            ${vehicle.entryCompleted ? t.btnToggleComplete : t.btnTogglePending}
                        </button>
                        <button class="btn btn-small btn-secondary" onclick="editVehicle(${vehicle.id})">${t.btnEdit}</button>
                        <button class="btn btn-small btn-danger" onclick="deleteVehicle(${vehicle.id}, '${vehicle.registeredBy}')">${t.btnDelete}</button>
                    </div>
                </div>
            `).join('');
        }

        // ì…ì°¨ ìƒíƒœ í† ê¸€
        function toggleEntryStatus(id) {
            const vehicles = loadVehicles();
            const vehicle = vehicles.find(v => v.id === id);
            if (vehicle) {
                vehicle.entryCompleted = !vehicle.entryCompleted;
                saveVehicles(vehicles);
                renderVehicleList();
            }
        }

        // ì°¨ëŸ‰ ì •ë³´ ì‚­ì œ
        function deleteVehicle(id, registeredBy) {
            const userName = localStorage.getItem('lastSelectedUser');

            // ë³¸ì¸ì´ ë“±ë¡í•œ ê²ƒë§Œ ì‚­ì œ ê°€ëŠ¥
            if (userName !== registeredBy) {
                alert(TRANSLATIONS[currentLang].deleteOwnOnly);
                return;
            }

            if (confirm(TRANSLATIONS[currentLang].deleteConfirm)) {
                let vehicles = loadVehicles();
                vehicles = vehicles.filter(v => v.id !== id);
                saveVehicles(vehicles);
                renderVehicleList();
            }
        }

        // ì°¨ëŸ‰ ì •ë³´ ìˆ˜ì •
        function editVehicle(id) {
            const vehicles = loadVehicles();
            const vehicle = vehicles.find(v => v.id === id);

            if (!vehicle) return;

            const userName = localStorage.getItem('lastSelectedUser');

            // ë³¸ì¸ì´ ë“±ë¡í•œ ê²ƒë§Œ ìˆ˜ì • ê°€ëŠ¥
            if (userName !== vehicle.registeredBy) {
                alert(TRANSLATIONS[currentLang].editOwnOnly);
                return;
            }

            // ë“±ë¡ íƒ­ìœ¼ë¡œ ì´ë™
            switchTab('register');

            // í¼ì— ë°ì´í„° ì±„ìš°ê¸°
            document.getElementById('userName').value = vehicle.registeredBy;
            document.getElementById('entryDate').value = vehicle.entryDate;
            document.getElementById('clientName').value = vehicle.clientName;
            document.getElementById('orderNumber').value = vehicle.orderNumber;
            document.getElementById('headNumber').value = vehicle.headNumber;
            document.getElementById('trailerNumber').value = vehicle.trailerNumber;
            document.getElementById('driverName').value = vehicle.driverName;
            document.getElementById('driverPassport').value = vehicle.driverPassport;
            document.getElementById('driverPhone').value = vehicle.driverPhone;
            document.getElementById('entryTime').value = vehicle.entryTime;
            document.getElementById('entryCompleted').checked = vehicle.entryCompleted;

            // ê¸°ì¡´ ë°ì´í„° ì‚­ì œ (ìˆ˜ì • í›„ ìƒˆë¡œ ë“±ë¡)
            const updatedVehicles = vehicles.filter(v => v.id !== id);
            saveVehicles(updatedVehicles);
        }

        // í•„í„° ë³€ê²½
        let currentFilter = 'all';
        function filterVehicles(filter) {
            currentFilter = filter;

            // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            renderVehicleList(filter);
        }

        // ê²€ìƒ‰
        document.getElementById('searchInput').addEventListener('input', function() {
            renderVehicleList(currentFilter);
        });

        // CSV ë‚´ë³´ë‚´ê¸°
        function exportToCSV() {
            const vehicles = loadVehicles();

            if (vehicles.length === 0) {
                alert(currentLang === 'ko' ? 'ë‚´ë³´ë‚¼ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.' : 'ĞĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ´Ğ»Ñ ÑĞºÑĞ¿Ğ¾Ñ€Ñ‚Ğ°.');
                return;
            }

            // CSV í—¤ë” (í•œêµ­ì–´/ëŸ¬ì‹œì•„ì–´)
            const headers = currentLang === 'ko'
                ? ['ë“±ë¡ì¼ì‹œ', 'ë“±ë¡ì', 'ì…ì°¨ë‚ ì§œ', 'ê±°ë˜ì²˜ëª…', 'ì£¼ë¬¸ë²ˆí˜¸', 'í—¤ë“œë²ˆí˜¸', 'íŠ¸ë ˆì¼ëŸ¬ë²ˆí˜¸', 'ìš´ì „ìëª…', 'ìš´ì „ìì—¬ê¶Œ', 'ìš´ì „ìì „í™”', 'ì…ì°¨ì˜ˆì •ì‹œê°', 'ì…ì°¨ì™„ë£Œì—¬ë¶€']
                : ['Ğ”Ğ°Ñ‚Ğ° Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸', 'Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€', 'Ğ”Ğ°Ñ‚Ğ° Ğ²ÑŠĞµĞ·Ğ´Ğ°', 'ĞšĞ»Ğ¸ĞµĞ½Ñ‚', 'ĞĞ¾Ğ¼ĞµÑ€ Ğ·Ğ°ĞºĞ°Ğ·Ğ°', 'ĞĞ¾Ğ¼ĞµÑ€ Ñ‚ÑĞ³Ğ°Ñ‡Ğ°', 'ĞĞ¾Ğ¼ĞµÑ€ Ğ¿Ñ€Ğ¸Ñ†ĞµĞ¿Ğ°', 'Ğ¤Ğ˜Ğ Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»Ñ', 'ĞŸĞ°ÑĞ¿Ğ¾Ñ€Ñ‚', 'Ğ¢ĞµĞ»ĞµÑ„Ğ¾Ğ½', 'Ğ’Ñ€ĞµĞ¼Ñ Ğ²ÑŠĞµĞ·Ğ´Ğ°', 'Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ'];

            // CSV ë°ì´í„° í–‰ ìƒì„±
            const rows = vehicles.map(v => {
                const registeredAt = new Date(v.registeredAt).toLocaleString('ko-KR');
                const completedText = currentLang === 'ko'
                    ? (v.entryCompleted ? 'ì™„ë£Œ' : 'ëŒ€ê¸°')
                    : (v.entryCompleted ? 'Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¾' : 'ĞĞ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ');

                return [
                    registeredAt,
                    v.registeredBy || '',
                    v.entryDate || '',
                    v.clientName || '',
                    v.orderNumber || '',
                    v.headNumber || '',
                    v.trailerNumber || '',
                    v.driverName || '',
                    v.driverPassport || '',
                    v.driverPhone || '',
                    v.entryTime || '',
                    completedText
                ].map(field => `"${field}"`).join(',');
            });

            // CSV ë¬¸ìì—´ ìƒì„±
            const csvContent = [
                headers.map(h => `"${h}"`).join(','),
                ...rows
            ].join('\n');

            // BOM ì¶”ê°€ (ì—‘ì…€ì—ì„œ í•œê¸€/ëŸ¬ì‹œì•„ì–´ ê¹¨ì§ ë°©ì§€)
            const BOM = '\uFEFF';
            const blob = new Blob([BOM + csvContent], { type: 'text/csv;charset=utf-8;' });

            // íŒŒì¼ ë‹¤ìš´ë¡œë“œ
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            const today = new Date().toISOString().split('T')[0];

            link.setAttribute('href', url);
            link.setAttribute('download', `Lotte_Vehicle_Registration_${today}.csv`);
            link.style.visibility = 'hidden';

            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);

            // ì„±ê³µ ë©”ì‹œì§€
            const message = currentLang === 'ko'
                ? `${vehicles.length}ê°œì˜ ì°¨ëŸ‰ ë°ì´í„°ë¥¼ CSVë¡œ ë‚´ë³´ëƒˆìŠµë‹ˆë‹¤.`
                : `Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾ ${vehicles.length} Ğ·Ğ°Ğ¿Ğ¸ÑĞµĞ¹ Ğ² CSV.`;
            alert(message);
        }

        // Google Sheets ë™ê¸°í™”
        async function syncToGoogleSheet(vehicle) {
            const settings = loadSettings();
            if (!settings.googleSheetUrl) return;

            try {
                await fetch(settings.googleSheetUrl, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: 'addVehicle',
                        data: vehicle
                    })
                });
            } catch (error) {
                console.error('Google Sheets ë™ê¸°í™” ì‹¤íŒ¨:', error);
            }
        }

        // íƒ­ ì „í™˜
        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            if (tabName === 'list') {
                renderVehicleList(currentFilter);
            } else if (tabName === 'settings') {
                const settings = loadSettings();
                document.getElementById('googleSheetUrl').value = settings.googleSheetUrl;
            }
        }

        // ì–¸ì–´ ì „í™˜ í•¨ìˆ˜
        function switchLanguage(lang) {
            currentLang = lang;
            localStorage.setItem(STORAGE_KEYS.language, lang);

            // ë²„íŠ¼ active ìƒíƒœ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // UI ì—…ë°ì´íŠ¸
            updateLanguage();
        }

        // ì•ˆì „í•˜ê²Œ ìš”ì†Œ ì—…ë°ì´íŠ¸í•˜ëŠ” í—¬í¼ í•¨ìˆ˜
        function safeSetText(selector, text, isId = false) {
            try {
                const element = isId ? document.getElementById(selector) : document.querySelector(selector);
                if (element) {
                    element.textContent = text;
                    return true;
                }
                return false;
            } catch (e) {
                return false;
            }
        }

        function safeSetPlaceholder(id, text) {
            try {
                const element = document.getElementById(id);
                if (element) {
                    element.placeholder = text;
                    return true;
                }
                return false;
            } catch (e) {
                return false;
            }
        }

        // ì–¸ì–´ì— ë§ê²Œ UI ì—…ë°ì´íŠ¸
        function updateLanguage() {
            try {
                const t = TRANSLATIONS[currentLang];

            // ë¡œê·¸ì¸ í˜ì´ì§€
            document.getElementById('loginTitle').textContent = t.loginTitle;
            document.getElementById('loginSubtitle').textContent = t.loginSubtitle;
            document.getElementById('loginUsernameLabel').textContent = t.username;
            document.getElementById('loginPasswordLabel').textContent = t.password;
            document.getElementById('rememberMeLabel').textContent = t.rememberMe;
            document.getElementById('loginBtn').textContent = t.loginBtn;
            document.getElementById('loginError').textContent = t.loginError;

            // í—¤ë”
            safeSetText('.header h1', t.title);

            const subtitleEl = document.querySelector('.subtitle');
            if (subtitleEl) {
                subtitleEl.innerHTML = t.subtitle + ' <span style="font-size: 0.75em; color: #fff; margin-left: 8px;">v0.1</span>';
            }

            // íƒ­ ë²„íŠ¼
            const tabBtns = document.querySelectorAll('.tab-btn');
            if (tabBtns.length >= 3) {
                tabBtns[0].textContent = t.tabRegister;
                tabBtns[1].textContent = t.tabList;
                tabBtns[2].textContent = t.tabSettings;
            }

            // ì°¨ëŸ‰ ë“±ë¡ í¼
            safeSetText('#register h2', t.registerTitle);
            document.querySelector('label[for="userName"]').textContent = t.userName;
            document.querySelector('#userName option[value=""]').textContent = t.selectPlaceholder;
            document.querySelector('label[for="entryDate"]').textContent = t.entryDate;
            document.querySelector('label[for="clientName"]').textContent = t.clientName;
            document.getElementById('clientName').placeholder = t.clientPlaceholder;
            document.querySelector('label[for="orderNumber"]').textContent = t.orderNumber;
            document.getElementById('orderNumber').placeholder = t.orderPlaceholder;
            document.querySelector('label[for="headNumber"]').textContent = t.headNumber;
            document.getElementById('headNumber').placeholder = t.headPlaceholder;
            document.querySelector('label[for="trailerNumber"]').textContent = t.trailerNumber;
            document.getElementById('trailerNumber').placeholder = t.trailerPlaceholder;
            document.querySelector('label[for="driverName"]').textContent = t.driverName;
            document.getElementById('driverName').placeholder = t.driverNamePlaceholder;
            document.querySelector('label[for="driverPassport"]').textContent = t.driverPassport;
            document.getElementById('driverPassport').placeholder = t.passportPlaceholder;
            document.querySelector('label[for="driverPhone"]').textContent = t.driverPhone;
            document.getElementById('driverPhone').placeholder = t.phonePlaceholder;
            document.querySelector('label[for="entryTime"]').textContent = t.entryTime;
            document.querySelector('label[for="entryCompleted"]').textContent = t.entryCompleted;
            document.getElementById('submitBtn').textContent = t.submitBtn;
            document.getElementById('successMessage').textContent = t.successMessage;

            // ë“±ë¡ í˜„í™©
            safeSetText('#list h2', t.listTitle);
            document.getElementById('searchInput').placeholder = t.searchPlaceholder;

            const filterBtns = document.querySelectorAll('.filter-btn');
            filterBtns[0].textContent = t.filterAll;
            filterBtns[1].textContent = t.filterToday;
            filterBtns[2].textContent = t.filterPending;
            filterBtns[3].textContent = t.filterCompleted;

            document.getElementById('exportBtnText').textContent = t.exportBtn;

            // ì„¤ì •
            safeSetText('#settings h2', t.settingsTitle);
            safeSetText('label[for="googleSheetUrl"]', t.googleSheetUrl);
            safeSetPlaceholder('googleSheetUrl', t.googleSheetPlaceholder);
            safeSetText('#settings h3', t.userManagement);
            safeSetText('#settings .btn', t.btnSave);

            // AI ì—…ë¡œë“œ ì„¹ì…˜
            safeSetText('.ai-upload-section h3', t.aiAutoFill);

            const aiTabBtns = document.querySelectorAll('.ai-tab-btn');
            if (aiTabBtns.length >= 2) {
                aiTabBtns[0].textContent = t.aiTabImage;
                aiTabBtns[1].textContent = t.aiTabText;
            }

            safeSetText('.upload-text', t.uploadImage);
            safeSetText('.upload-hint', t.uploadHint);
            safeSetPlaceholder('textInput', t.textPlaceholder);
            safeSetText('.btn-extract', t.btnExtract);
            safeSetText('#clearImageBtn', t.clearImage, true);
            safeSetText('.processing-text', t.processing);

            // ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ê³¼ ì‚¬ìš©ì ì •ë³´
            const logoutBtn = document.querySelector('.logout-btn');
            if (logoutBtn) {
                logoutBtn.textContent = t.logout;
            }

            // ì‚¬ìš©ì ì •ë³´ ì—…ë°ì´íŠ¸
            const currentUser = localStorage.getItem(STORAGE_KEYS.currentUser);
            if (currentUser) {
                const user = JSON.parse(currentUser);
                document.getElementById('userInfo').textContent =
                    `${t.loggedInAs}: ${user.name} (${user.role})`;
            }

                // ë‚ ì§œ/ì‹œê°„ ì—…ë°ì´íŠ¸ (ì–¸ì–´ ë³€ê²½ ë°˜ì˜)
                updateDateTime();

                // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                renderVehicleList(currentFilter);
            } catch (error) {
                console.error('updateLanguage error:', error);
                // ì˜¤ë¥˜ê°€ ë°œìƒí•´ë„ ê³„ì† ì§„í–‰ (ì¼ë¶€ ìš”ì†Œê°€ ì—†ì„ ìˆ˜ ìˆìŒ)
            }
        }

        // ========== AI ì´ë¯¸ì§€ ì—…ë¡œë“œ ë° OCR ê¸°ëŠ¥ ==========

        // AI ì„¹ì…˜ í† ê¸€
        function toggleAISection() {
            const content = document.getElementById('aiSectionContent');
            const icon = document.querySelector('.ai-toggle-icon');

            content.classList.toggle('expanded');
            icon.classList.toggle('expanded');
        }

        // AI íƒ­ ì „í™˜
        function switchAITab(tab) {
            const tabs = document.querySelectorAll('.ai-tab-content');
            const btns = document.querySelectorAll('.ai-tab-btn');

            tabs.forEach(t => t.classList.remove('active'));
            btns.forEach(b => b.classList.remove('active'));

            if (tab === 'image') {
                document.getElementById('imageTab').classList.add('active');
                btns[0].classList.add('active');
            } else {
                document.getElementById('textTab').classList.add('active');
                btns[1].classList.add('active');
            }
        }

        // í…ìŠ¤íŠ¸ì—ì„œ ì •ë³´ ì¶”ì¶œ
        function extractFromText() {
            const text = document.getElementById('textInput').value;
            if (!text.trim()) {
                alert('í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const t = TRANSLATIONS[currentLang];

            // í…ìŠ¤íŠ¸ ì¶”ì¶œ í•¨ìˆ˜ í˜¸ì¶œ
            extractAndFillForm(text);

            // ì„±ê³µ ë©”ì‹œì§€
            const successMsg = document.getElementById('successMessage');
            successMsg.textContent = t.extractSuccess;
            successMsg.classList.add('show');
            setTimeout(() => {
                successMsg.classList.remove('show');
                successMsg.textContent = t.successMessage;
            }, 3000);

            // í…ìŠ¤íŠ¸ ì…ë ¥ì°½ ì´ˆê¸°í™”
            document.getElementById('textInput').value = '';
        }

        // ì´ë¯¸ì§€ ì—…ë¡œë“œ ì˜ì—­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        const uploadArea = document.getElementById('uploadArea');
        const imageInput = document.getElementById('imageInput');
        const imagePreview = document.getElementById('imagePreview');
        const clearImageBtn = document.getElementById('clearImageBtn');
        const processingOverlay = document.getElementById('processingOverlay');

        // í´ë¦­í•˜ì—¬ íŒŒì¼ ì„ íƒ
        uploadArea.addEventListener('click', () => {
            imageInput.click();
        });

        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì´ë²¤íŠ¸
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');

            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleImageUpload(files[0]);
            }
        });

        // íŒŒì¼ ì„ íƒ ì´ë²¤íŠ¸
        imageInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleImageUpload(e.target.files[0]);
            }
        });

        // ì´ë¯¸ì§€ ì œê±° ë²„íŠ¼
        clearImageBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            imagePreview.style.display = 'none';
            clearImageBtn.style.display = 'none';
            imageInput.value = '';
        });

        // ì´ë¯¸ì§€ ì—…ë¡œë“œ ì²˜ë¦¬
        async function handleImageUpload(file) {
            if (!file.type.startsWith('image/')) {
                alert('ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                return;
            }

            // ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°
            const reader = new FileReader();
            reader.onload = (e) => {
                imagePreview.src = e.target.result;
                imagePreview.style.display = 'block';
                clearImageBtn.style.display = 'inline-block';
            };
            reader.readAsDataURL(file);

            // OCR ì²˜ë¦¬
            await performOCR(file);
        }

        // OCR ì²˜ë¦¬ í•¨ìˆ˜
        async function performOCR(imageFile) {
            const t = TRANSLATIONS[currentLang];
            processingOverlay.classList.add('show');

            try {
                const { data: { text } } = await Tesseract.recognize(
                    imageFile,
                    'rus+eng', // ëŸ¬ì‹œì•„ì–´ + ì˜ì–´
                    {
                        logger: info => {
                            // ì§„í–‰ ìƒí™© ë¡œê¹… (ì„ íƒì‚¬í•­)
                            if (info.status === 'recognizing text') {
                                const progress = Math.round(info.progress * 100);
                                document.querySelector('.processing-text').textContent =
                                    `${t.processing} ${progress}%`;
                            }
                        }
                    }
                );

                // í…ìŠ¤íŠ¸ íŒŒì‹± ë° í¼ ì±„ìš°ê¸°
                extractAndFillForm(text);

                processingOverlay.classList.remove('show');

                // ì„±ê³µ ë©”ì‹œì§€
                const successMsg = document.getElementById('successMessage');
                successMsg.textContent = t.extractSuccess;
                successMsg.classList.add('show');
                setTimeout(() => {
                    successMsg.classList.remove('show');
                    successMsg.textContent = t.successMessage;
                }, 3000);

            } catch (error) {
                console.error('OCR ì˜¤ë¥˜:', error);
                processingOverlay.classList.remove('show');
                alert(t.extractError);
            }
        }

        // í…ìŠ¤íŠ¸ì—ì„œ ì •ë³´ ì¶”ì¶œ ë° í¼ ì±„ìš°ê¸°
        function extractAndFillForm(text) {
            console.log('ì¶”ì¶œëœ í…ìŠ¤íŠ¸:', text);

            const learningData = loadLearningData();
            const extractedData = {
                clientName: '',
                orderNumber: '',
                headNumber: '',
                trailerNumber: '',
                driverName: '',
                driverPassport: '',
                driverPhone: '',
                entryTime: ''
            };

            // ì—¬ê¶Œ ë²ˆí˜¸ - ë¼ë²¨ í¬í•¨ ì²˜ë¦¬ (ĞŸĞ°ÑĞ¿Ğ¾Ñ€Ñ‚:, Passport: ë“±)
            // í‚¤ë¦´ ë¬¸ìì™€ ë¼í‹´ ë¬¸ì ëª¨ë‘ ì§€ì›
            let passportMatch = text.match(/(?:ĞŸĞ°ÑĞ¿Ğ¾Ñ€Ñ‚|Passport|Ğ¿Ğ°ÑĞ¿Ğ¾Ñ€Ñ‚|passport):\s*([A-ZĞ-Ğ¯Ğ]{2}\s?\d{7,8})/i);
            if (!passportMatch) {
                // ë¼ë²¨ ì—†ì´ íŒ¨í„´ë§Œ ì°¾ê¸°
                passportMatch = text.match(/[A-ZĞ-Ğ¯Ğ]{2}\s?\d{7,8}/i);
            }
            if (passportMatch) {
                let passport = (passportMatch[1] || passportMatch[0]).replace(/\s/g, '').toUpperCase();
                // í‚¤ë¦´ ë¬¸ìë¥¼ ë¼í‹´ ë¬¸ìë¡œ ë³€í™˜ (Ğœ->M, Ğ¡->C, Ğ->H ë“±)
                passport = passport.replace(/Ğœ/g, 'M').replace(/Ğ¡/g, 'C').replace(/Ğ/g, 'H')
                    .replace(/Ğ/g, 'A').replace(/Ğ’/g, 'B').replace(/Ğ•/g, 'E')
                    .replace(/Ğš/g, 'K').replace(/Ğ/g, 'O').replace(/Ğ /g, 'P')
                    .replace(/Ğ¢/g, 'T').replace(/Ğ¥/g, 'X');

                // í•™ìŠµëœ íŒ¨í„´ ì ìš©
                if (learningData.passportMappings[passport]) {
                    passport = learningData.passportMappings[passport];
                }
                extractedData.driverPassport = passport;
                document.getElementById('driverPassport').value = passport;
            }

            // ì°¨ëŸ‰ ë²ˆí˜¸ íŒ¨í„´ (ì˜ˆ: AX3623-5, A39101-5, A3910I-5)
            // Ië¥¼ 1ë¡œ ìë™ ë³€í™˜
            const vehicleMatches = text.match(/[A-Z]{1,2}\d{4,5}[-\s\/]?\d{1}|[A-Z]{1,2}\d{3,4}[I1][-\s\/]?\d{1}/gi);
            if (vehicleMatches && vehicleMatches.length >= 1) {
                // ì²« ë²ˆì§¸ë¥¼ í—¤ë“œë¡œ (Ië¥¼ 1ë¡œ ë³€í™˜)
                extractedData.headNumber = vehicleMatches[0].replace(/\s/g, '').replace(/\//g, '').replace(/I/gi, '1');
                document.getElementById('headNumber').value = extractedData.headNumber;
                // ë‘ ë²ˆì§¸ê°€ ìˆìœ¼ë©´ íŠ¸ë ˆì¼ëŸ¬ë¡œ
                if (vehicleMatches.length >= 2) {
                    extractedData.trailerNumber = vehicleMatches[1].replace(/\s/g, '').replace(/\//g, '').replace(/I/gi, '1');
                    document.getElementById('trailerNumber').value = extractedData.trailerNumber;
                }
            }

            // ìš´ì „ì ì´ë¦„ - ë¼ë²¨ í¬í•¨ ì²˜ë¦¬
            // Ğ¤Ğ°Ğ¼Ğ¸Ğ»Ğ¸Ñ:, Ğ˜Ğ¼Ñ:, ĞÑ‚Ñ‡ĞµÑÑ‚Ğ²Ğ¾: í˜•ì‹ ì²˜ë¦¬
            let surname = '', firstName = '', patronymic = '';

            const surnameMatch = text.match(/(?:Ğ¤Ğ°Ğ¼Ğ¸Ğ»Ğ¸Ñ|Surname|Ñ„Ğ°Ğ¼Ğ¸Ğ»Ğ¸Ñ):\s*([Ğ-Ğ¯Ğ][Ğ°-ÑÑ‘]+)/i);
            if (surnameMatch) surname = surnameMatch[1];

            const firstNameMatch = text.match(/(?:Ğ˜Ğ¼Ñ|Name|Ğ¸Ğ¼Ñ):\s*([Ğ-Ğ¯Ğ][Ğ°-ÑÑ‘]+)/i);
            if (firstNameMatch) firstName = firstNameMatch[1];

            const patronymicMatch = text.match(/(?:ĞÑ‚Ñ‡ĞµÑÑ‚Ğ²Ğ¾|Patronymic|Ğ¾Ñ‚Ñ‡ĞµÑÑ‚Ğ²Ğ¾):\s*([Ğ-Ğ¯Ğ][Ğ°-ÑÑ‘]+)/i);
            if (patronymicMatch) patronymic = patronymicMatch[1];

            // ë¼ë²¨ì´ ìˆëŠ” ê²½ìš°
            if (surname && firstName && patronymic) {
                let fullName = `${surname} ${firstName} ${patronymic}`;
                // í•™ìŠµëœ íŒ¨í„´ ì ìš©
                if (learningData.nameMappings[fullName]) {
                    fullName = learningData.nameMappings[fullName];
                }
                extractedData.driverName = fullName;
                document.getElementById('driverName').value = fullName;
            } else {
                // ë¼ë²¨ ì—†ì´ ì—°ì†ëœ 3ë‹¨ì–´ íŒ¨í„´ ì°¾ê¸°
                const nameMatch = text.match(/([Ğ-Ğ¯Ğ][Ğ°-ÑÑ‘]+)\s+([Ğ-Ğ¯Ğ][Ğ°-ÑÑ‘]+)\s+([Ğ-Ğ¯Ğ][Ğ°-ÑÑ‘]+)/);
                if (nameMatch) {
                    let fullName = `${nameMatch[1]} ${nameMatch[2]} ${nameMatch[3]}`;
                    // í•™ìŠµëœ íŒ¨í„´ ì ìš©
                    if (learningData.nameMappings[fullName]) {
                        fullName = learningData.nameMappings[fullName];
                    }
                    extractedData.driverName = fullName;
                    document.getElementById('driverName').value = fullName;
                }
            }

            // ê±°ë˜ì²˜ëª… - í•™ìŠµëœ íŒ¨í„´ ìš°ì„  ì ìš©
            let clientName = '';
            const keywords = extractClientKeywords(text);
            for (const keyword of keywords) {
                if (learningData.clientMappings[keyword]) {
                    clientName = learningData.clientMappings[keyword];
                    break;
                }
            }
            // í•™ìŠµëœ íŒ¨í„´ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ íŒ¨í„´ ì‚¬ìš©
            if (!clientName) {
                const clientMatch = text.match(/(?:Ğ›ĞĞ¢Ğ¢Ğ•|LOTTE|Ğ›Ğ[TĞ¢]{2}Ğ•)/i);
                if (clientMatch) {
                    clientName = 'Ğ›ĞĞ¢Ğ¢Ğ•';
                }
            }
            if (clientName) {
                extractedData.clientName = clientName;
                document.getElementById('clientName').value = clientName;
            }

            // ë‚ ì§œ - "Ğ”Ğ°Ñ‚Ğ° Ñ€Ğ¾Ğ¶Ğ´ĞµĞ½Ğ¸Ñ:" ë¼ë²¨ ë¬´ì‹œí•˜ê³  ë‚ ì§œë§Œ ì¶”ì¶œ
            // ì˜¤ëŠ˜ ë‚ ì§œë¥¼ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš© (ìƒë…„ì›”ì¼ì´ ì•„ë‹Œ ì…ì°¨ ë‚ ì§œê°€ í•„ìš”í•¨)
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('entryDate').value = today;

            // ë§Œì•½ í…ìŠ¤íŠ¸ì— ì…ì°¨ ë‚ ì§œê°€ ëª…ì‹œë˜ì–´ ìˆë‹¤ë©´ ì¶”ì¶œ
            const entryDateMatch = text.match(/(?:Ğ”Ğ°Ñ‚Ğ°|Date|Ğ´Ğ°Ñ‚Ğ°|date)(?:\s+Ğ²ÑŠĞµĞ·Ğ´Ğ°|\s+entry)?:\s*(\d{1,2})[.\-\/](\d{1,2})[.\-\/](\d{2,4})/i);
            if (entryDateMatch) {
                let day = entryDateMatch[1].padStart(2, '0');
                let month = entryDateMatch[2].padStart(2, '0');
                let year = entryDateMatch[3];
                if (year.length === 2) {
                    year = '20' + year;
                }
                document.getElementById('entryDate').value = `${year}-${month}-${day}`;
            }

            // ì „í™”ë²ˆí˜¸ (ëŸ¬ì‹œì•„ í˜•ì‹: +7 Ğ¸Ğ»Ğ¸ 8)
            const phoneMatch = text.match(/(?:\+7|8)\s?[\d\s\-()]{10,}/);
            if (phoneMatch) {
                let phone = phoneMatch[0].replace(/[\s\-()]/g, '');
                // +7 í˜•ì‹ìœ¼ë¡œ í†µì¼
                if (phone.startsWith('8')) {
                    phone = '+7' + phone.substring(1);
                }
                extractedData.driverPhone = phone;
                document.getElementById('driverPhone').value = phone;
            }

            // ì£¼ë¬¸ë²ˆí˜¸ íŒ¨í„´ - í•™ìŠµëœ íŒ¨í„´ ìš°ì„  ì ìš©
            let orderNumber = '';
            for (const pattern in learningData.orderMappings) {
                if (text.includes(pattern)) {
                    orderNumber = learningData.orderMappings[pattern];
                    break;
                }
            }
            // í•™ìŠµëœ íŒ¨í„´ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ íŒ¨í„´ ì‚¬ìš©
            if (!orderNumber) {
                const orderMatch = text.match(/(?:â„–|#|N)\s?([A-Z0-9]+\/\d+|[A-Z]?\d+\/\d+)/i);
                if (orderMatch) {
                    orderNumber = orderMatch[1];
                }
            }
            if (orderNumber) {
                extractedData.orderNumber = orderNumber;
                document.getElementById('orderNumber').value = orderNumber;
            }

            // ì¶”ì¶œëœ ë°ì´í„°ì™€ ì›ë³¸ í…ìŠ¤íŠ¸ ì €ì¥ (í•™ìŠµìš©)
            localStorage.setItem(STORAGE_KEYS.lastOcrExtraction, JSON.stringify({
                originalText: text,
                extractedData: extractedData,
                timestamp: new Date().toISOString()
            }));
        }

        // ì‹¤ì‹œê°„ ë‚ ì§œ/ì‹œê°„ ì—…ë°ì´íŠ¸
        function updateDateTime() {
            try {
                const now = new Date();

                // ë‚ ì§œ í˜•ì‹ (ëŸ¬ì‹œì•„ì–´/í•œêµ­ì–´)
                let dateStr;
                if (currentLang === 'ru') {
                    const months = ['ÑĞ½Ğ²Ğ°Ñ€Ñ', 'Ñ„ĞµĞ²Ñ€Ğ°Ğ»Ñ', 'Ğ¼Ğ°Ñ€Ñ‚Ğ°', 'Ğ°Ğ¿Ñ€ĞµĞ»Ñ', 'Ğ¼Ğ°Ñ', 'Ğ¸ÑĞ½Ñ',
                                   'Ğ¸ÑĞ»Ñ', 'Ğ°Ğ²Ğ³ÑƒÑÑ‚Ğ°', 'ÑĞµĞ½Ñ‚ÑĞ±Ñ€Ñ', 'Ğ¾ĞºÑ‚ÑĞ±Ñ€Ñ', 'Ğ½Ğ¾ÑĞ±Ñ€Ñ', 'Ğ´ĞµĞºĞ°Ğ±Ñ€Ñ'];
                    dateStr = `${now.getDate()} ${months[now.getMonth()]} ${now.getFullYear()} Ğ³.`;
                } else {
                    dateStr = `${now.getFullYear()}ë…„ ${(now.getMonth() + 1)}ì›” ${now.getDate()}ì¼`;
                }

                // ì‹œê°„ í˜•ì‹ (24ì‹œê°„)
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                const seconds = String(now.getSeconds()).padStart(2, '0');
                const timeStr = `${hours}:${minutes}:${seconds}`;

                // DOM ì—…ë°ì´íŠ¸
                const dateElement = document.getElementById('currentDate');
                const timeElement = document.getElementById('currentTime');

                if (dateElement) dateElement.textContent = dateStr;
                if (timeElement) timeElement.textContent = timeStr;

                console.log('DateTime updated:', dateStr, timeStr);
            } catch (error) {
                console.error('updateDateTime error:', error);
                // ì˜¤ë¥˜ ë°œìƒ ì‹œì—ë„ ê¸°ë³¸ ì‹œê°„ í‘œì‹œ
                const now = new Date();
                const dateElement = document.getElementById('currentDate');
                const timeElement = document.getElementById('currentTime');
                if (dateElement) dateElement.textContent = now.toLocaleDateString('ko-KR');
                if (timeElement) timeElement.textContent = now.toLocaleTimeString('ko-KR');
            }
        }

        // ì´ˆê¸°í™”
        window.addEventListener('load', function() {
            // ë¡œê·¸ì¸ í¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            document.getElementById('loginForm').addEventListener('submit', handleLogin);

            // ì €ì¥ëœ ì–¸ì–´ ë¶ˆëŸ¬ì˜¤ê¸°
            const savedLang = localStorage.getItem(STORAGE_KEYS.language) || 'ru';
            currentLang = savedLang;

            // ì–¸ì–´ ë²„íŠ¼ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if ((savedLang === 'ru' && btn.textContent === 'RUS') ||
                    (savedLang === 'ko' && btn.textContent === 'KOR')) {
                    btn.classList.add('active');
                }
            });

            // ì–¸ì–´ ì ìš©
            console.log('Applying language...');
            updateLanguage();

            // ë‚ ì§œ/ì‹œê°„ ì¦‰ì‹œ ì—…ë°ì´íŠ¸ ë° ì‹œì‘
            console.log('Starting datetime update...');
            updateDateTime();
            if (dateTimeInterval) clearInterval(dateTimeInterval);
            dateTimeInterval = setInterval(updateDateTime, 1000);
            console.log('DateTime interval started');

            // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
            console.log('Checking login status...');
            checkLoginStatus();

            renderUserSelect();

            // ì˜¤ëŠ˜ ë‚ ì§œ ìë™ ì„¤ì •
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('entryDate').value = today;
        });
    </script>
</body>
</html>
